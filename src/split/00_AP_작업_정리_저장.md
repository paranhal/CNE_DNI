# AP 장비 작업 정리 (저장용)

> **저장일:** 2026-02-21  
> **다음 작업:** 다른 장비로 전환

---

## 1. 작업 개요

### 완료된 작업
- 학교별 AP 장비 현황 엑셀 분리 스크립트 구축
- 12열 형식 (학교코드, 장비명, 관리번호, 모델명, 제조사, 학교명, 건물명, 층, 실, 수용망, 비고, AP위치)
- 50개 학교 파일 생성 (split_log_20260222.csv 기준)
- 양대초등학교·천안신안초등학교 데이터 추가 완료 (파일 생성 대기)

### 미완료
- **청파초등학교외연도분교장** (N108171103ES): 데이터 없음 → `missed_schools.csv`에 등록

---

## 2. 파일 구조

```
d:\Lee_20260202\보고서작성\기호준_측정값\
├── 00.충남_AP_자산_첨부(충남전체)_.xlsx   # 원본 (AP_충남전체 시트)
├── SCHOOL_REG_LIST.XLSX                    # 학교 리스트
├── split_school_ap_v1.py                      # 메인 분리 스크립트
├── check_structure.py                      # 원본 구조 확인
├── extract_missed_schools.py               # 빠진 학교 리스트 추출
├── verify_missing_by_code.py               # 학교코드 기준 누락 검증
├── compare_school_files.py                 # 학교 파일 비교
├── split_school_switch_v1.py              # 스위치 장비 분리 (V1)
├── check_structure_switch.py              # 스위치 원본 구조 확인
├── missed_schools.csv                       # 미처리 학교 (현재 1개)
├── split_log.csv                           # 전체 처리 로그
├── split_log_20260222.csv                  # 2026-02-22 실행 로그 (53개)
├── run_2schools.bat                        # 양대·천안신안초 2개 학교 실행용
├── .cursor\rules\log-append-rule.mdc       # 공통 규칙 (로그 추가/신규)
└── 00_AP_작업_정리_저장.md                 # 본 문서
```

---

## 3. 출력 경로 (--test 규칙)

**모든 장비 현황 상세 스크립트 공통:**
- `--test` / `-t` 있음 → `{작업폴더}/OUTPUT/{지역}/{학교명}_{학교코드}/` 에 저장
- `--test` 없음 → 실제 목표 `Y:\CNE_DNI\_지역별 산출물 취합\_00.별첨자료_학교별\CNE\` 에 저장

**보안장비, POE, 대전 지역 스크립트 생성 시에도 동일 로직 유지**

---

## 4. split_school_ap_v1.py 옵션

| 옵션 | 설명 |
|------|------|
| (없음) | 전체 학교 처리 |
| `--missed-only` | missed_schools.csv에 있는 학교만 |
| `--only-schools 코드1,코드2` | 지정 학교만 (예: N108151062ES,N108151079ES) |
| `--schools-file 파일` | 학교코드 목록 파일 |
| `--today-from-missed` | missed_schools.csv 학교만 |
| `--from-log 파일` | 로그 파일의 학교만 (예: split_log_20260222.csv) |
| `--new-log` | 이번 실행만 별도 로그 파일 생성 |
| `--source 경로` | 원본 엑셀 파일 지정 |
| `--test` / `-t` | 테스트: OUTPUT 폴더에 생성 (없으면 실제 Y:\...\CNE 저장) |

---

## 5. 로그 규칙 (공통)

**미션이 달라지면** 덮어쓰지 말고:
- 기존 로그에 **추가(병합)** 또는
- `--new-log`로 **신규 파일** 생성

---

## 6. 다음에 AP 재개할 때

### 테스트 (OUTPUT 폴더)
```cmd
python split_school_ap_v1.py --test
```

### 2개 학교(양대·천안신안초) 파일 생성
```cmd
python split_school_ap_v1.py --only-schools N108151062ES,N108151079ES
```
또는 `run_2schools.bat` 실행

### 52개 전체 재생성
```cmd
python split_school_ap_v1.py --from-log split_log_20260222.csv
```

---

## 9. 스위치 장비 (split_school_switch_v1.py)

### 테스트 (OUTPUT 폴더에 생성)
```cmd
python split_school_switch_v1.py --test
```
또는 `run_switch_test.bat` 실행

### 최종 (Y:\CNE_DNI\...\CNE 폴더)
```cmd
python split_school_switch_v1.py
```

### 외연도분교장 데이터 추가 후
```cmd
python split_school_ap_v1.py --today-from-missed
```

---

## 7. 필요한 패키지

```
pip install openpyxl pandas
```

---

## 8. 전체 작업 계획 (충남 → 대전)

### 공통 사용 파일 (충남·대전 모두)
- **SCHOOL_REG_LIST.XLSX** : 학교 리스트 (AP 때와 동일)
- **지역별 학교 리스트** : AP 때와 동일 파일 사용

### 충남 지역
| 장비 | 원본 파일 | 비고 |
|------|-----------|------|
| AP | 00.충남_AP_자산_첨부(충남전체)_.xlsx | 12열, AP위치 있음 |
| 스위치 | CNE_SWITCH_LIST.xlsx | 서식 유사, AP위치 없음, split_school_switch_v1.py |
| POE | (원본 업로드 예정) | 서식 유사, AP위치 없음 |
| 보안장비 | (원본 업로드 예정) | 서식 유사, AP위치 없음 |

**충남 관련 자료는 모두 동일한 학교 리스트·지역 파일 사용**

### 대전 지역
- 충남 작업 완료 후 동일 방식으로 진행
- 학교 리스트·지역 파일은 대전용으로 별도 사용 예정
