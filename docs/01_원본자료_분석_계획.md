# 원본 자료 분석 계획

## 1. 원본 데이터 위치 및 구조

### 1.1 경로
- **루트**: `.../Lee_20260202/충남`
- **일반 지역**: `충남/XX_지역명/학교급/학교명_학교코드/` 또는 동일 레벨에 구성정보DB
- **보령**: `충남/06_보령/` 직하위에 통합 가상자산 엑셀 + `구성정보DB/` 폴더(학교코드별 구성정보 파일)

### 1.2 일반 지역(천안 등) 구조
- 지역 폴더 → 학교급(초등/중등/고등/특수) → **학교 폴더**(`학교명_학교코드`) 또는 루트에 구성정보
- 학교 폴더 내 파일 패턴: `{학교코드}_{장비유형}_일괄업로드용_가상자산DB.xlsx`, `{학교코드}_{장비유형}_일괄업로드용_구성정보DB.xlsx`
- 장비 유형 예: 스위치(SWL), PoE(PEL), AP, 보안장비(SEUTM), IPT 등

### 1.3 보령 지역 (예외 구조)
- `보령_AP_일괄업로드용_가상자산DB.xlsx` 등 **통합 가상자산** (장비별 한 파일에 여러 학교)
- `구성정보DB/` 폴더: `{학교코드}_{장비}_일괄업로드용_구성정보DB.xlsx` 형태로 **학교·장비별** 구성정보

---

## 2. 키값 및 분석 대상 장비

| 구분 | 내용 |
|------|------|
| **키값** | **관리코드** = `학교코드(12자리)-장비명+일련번호` (예: `N108140063HS-SWL20002`) |
| **분석 대상 장비** | SWL(스위치), PEL(PoE), AP, SEUTM(보안장비) |

---

## 3. 자료 분류

| 분류 | 설명 |
|------|------|
| **가상자산** | 자산 목록/속성 (학교정보 시트에 학교코드·학교명) |
| **구성정보** | 자산 간 연결(포트, 케이블, 상/하위 관계 등) |
| **장비** | 위 4종(SWL, PEL, AP, SEUTM) |

---

## 4. 분석 목표 (추후 통계)

- 장비별 수량·연결 구조 (예: 천안중학교 SWL 수, 스위치↔PoE↔보안장비 연결)
- 포트 구성: 포트 성능, 연결 여부/상태
- 케이블 종류·상태
- 상위/하위 장비 관계

---

## 5. 1차 분석 과제 (원본 검토)

### 5.1 시트·행 범위 파악
- 파일별 **어느 시트**, **몇 행 ~ 몇 행**이 실제 데이터인지
- 제목행(헤더) 위치, 데이터 시작/끝 행

### 5.2 데이터 품질 이슈 (수정 후 “수정본” 별도 저장)
- **관리번호 컬럼에 학교코드만 있는 경우** (관리코드 형식 아님)
- **한 학교 데이터 중간에 다른 학교코드가 섞인 경우**
- **기본 포맷과 다른 제목열** (컬럼명 불일치/추가)
- **컬럼명은 “관리번호”인데 값은 학교코드만 있는 경우**
- **학교코드 오기재**: 자릿수 추가, ES/MS/HS 누락·중복 등  
→ 이상 발견 시 **원본 수정 → “수정본” 이름으로 추가 저장** 예정

### 5.3 기준 정보
- **학교정보**: 가상자산 파일의 **“학교정보”** 시트 (학교코드·학교명)
- **기준 코드**: 학교코드, 학교명 (학교 수: 719개)
- **보령**: 통합 가상자산을 학교별로 구분할 때 위 학교정보 기준 사용

---

## 6. 다음 단계 (필요 자료)

아래 **기본 데이터 형태**가 준비되면 파일을 올려 주시면 됩니다.

1. **가상자산 파일** (장비별 시트 구성된 샘플 1개)
   - 시트 목록, 제목행, 데이터 시작/끝 행 정의용
2. **구성정보 파일** (장비별 시트 구성된 샘플 1개)
   - 시트 목록, 제목행, 데이터 시작/끝 행, 포트/케이블/연결 컬럼 정의용

이 두 종류 샘플을 받은 뒤:
- 시트별·파일별 **데이터 영역(시트명, 시작행~끝행)** 정리
- **관리코드/학교코드 검증 규칙** 및 이상 케이스 탐지 로직 설계
- 보령 통합 파일을 학교별로 나누는 로직 설계

**→ 가상자산·구성정보 샘플 파일 준비되시면 업로드 요청해 주세요.**
