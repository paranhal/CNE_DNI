# 통합 DB 실데이터 시트 정의

## 1. 요약

- **실데이터 시트**: 우리가 분석에 사용할 **장비/학교 목록·연결 데이터**가 있는 시트 (헤더 1행 + 데이터 2행~)
- **비실데이터 시트**: 관리번호 목록만 있는 시트, 설명(안내) 시트, 빈 시트 등 → **로딩 시 제외**

아래는 `충남_통합_가상자산DB_Lee.xlsx`, `충남_통합_구성정보DB_20260203_103132.xlsx` 기준으로 정리한 내용입니다.

---

## 2. 가상자산 DB (`충남_통합_가상자산DB_Lee.xlsx`)

| 시트명     | 용도           | 실데이터 여부 | 헤더 행 | 데이터 시작 | 데이터 끝(행) |
|-----------|----------------|---------------|---------|-------------|----------------|
| PoE       | PoE 장비 목록  | ✅ 실데이터   | 1       | 2           | 4,017          |
| AP        | AP 장비 목록   | ✅ 실데이터   | 1       | 2           | 18,286         |
| 스위치    | 스위치 목록    | ✅ 실데이터   | 1       | 2           | 13,561         |
| 보안장비  | 보안장비 목록  | ✅ 실데이터   | 1       | 2           | 1,436          |
| 학교정보  | 학교코드·학교명 | ✅ 실데이터   | 3       | 4           | 764            |

- **장비 시트 공통 헤더(1행)**  
  `장비명`, `관리번호`, `모델명`, `제조사`, `학교명`, `주소`, `건물명`, `층`, `실`, …  
  (스위치/보안장비는 컬럼명이 약간 다름: IP주소, Gate Way IP 등)
- **학교정보**  
  - 1~2행: 비어 있음  
  - 3행: `학교코드`, `지역`, `학교유형`, `학교명`, …  
  - 4행~: 실데이터

**사용할 실데이터 시트**: `PoE`, `AP`, `스위치`, `보안장비`, `학교정보` (위 5개 전부 실데이터).

---

## 3. 구성정보 DB (`충남_통합_구성정보DB_20260203_103132.xlsx`)

| 시트명    | 용도              | 실데이터 여부 | 헤더 행 | 데이터 시작 | 데이터 끝(행) |
|----------|-------------------|---------------|---------|-------------|----------------|
| AP       | AP 포트/연결 정보 | ✅ 실데이터   | 1       | 2           | 46,680         |
| PoE      | PoE 포트/연결 정보| ✅ 실데이터   | 1       | 2           | 104,816        |
| 스위치   | 스위치 포트/연결  | ✅ 실데이터   | 1       | 2           | 282,140        |
| 보안장비 | 보안장비 포트/연결| ✅ 실데이터   | 1       | 2           | 14,253         |

- **공통 헤더(1행)**  
  `장비명`, `관리번호`, `모델명`, `포트번호` 또는 `포트 번호`, `포트 TYPE`/`포트Type`, `설정 대역폭`, `포트상태 (Up/Down)`, `장비관리번호`, `Port`, `케이블 Type`(…), `비고`  
  (AP는 `포트 TYPE`, PoE/스위치/보안장비는 `포트 번호` 등 약간의 차이 있음)

**사용할 실데이터 시트**: `AP`, `PoE`, `스위치`, `보안장비` (4개 전부 실데이터).

---

## 4. 실데이터 시트 판별 기준 (다른 파일 적용 시)

다른 엑셀 파일(학교별·지역별)에서도 아래 기준으로 **실데이터만** 가져오면 됩니다.

1. **가상자산 – 장비 시트**  
   - 1행에 `관리번호`, `장비명`(또는 동일 의미 컬럼) 포함  
   - 2행부터 관리코드 형식(`학교코드-장비명+일련번호`) 데이터 존재  
   → **헤더=1행, 데이터=2행~**

2. **가상자산 – 학교정보**  
   - 시트명 `학교정보`  
   - 상단 빈 행 뒤 `학교코드`, `학교명` 등이 있는 행을 헤더로 인식  
   → **헤더=3행이면 데이터=4행~**

3. **구성정보 – 장비 시트**  
   - 1행에 `관리번호`, `장비관리번호`, `포트` 관련 컬럼 포함  
   - 2행부터 연결/포트 데이터 존재  
   → **헤더=1행, 데이터=2행~**

4. **제외할 시트**  
   - 시트명이 `설명`, `관리번호`(목록만 있는 경우), `목차` 등으로 보이는 시트  
   - 1행(또는 2행)이 위 헤더 패턴과 맞지 않고, 실데이터 행이 거의 없는 시트  
   → **비실데이터로 간주하고 로딩하지 않음**

---

## 5. 분석 시 사용할 시트만 로딩

- **가상자산**: `PoE`, `AP`, `스위치`, `보안장비`, `학교정보`  
  → 장비 4종(SWL/PEL/AP/SEUTM) + 학교 기준 정보
- **구성정보**: `AP`, `PoE`, `스위치`, `보안장비`  
  → 포트 구성, 케이블, 장비 간 연결 분석용

이외 시트(다른 통합 파일에서 관리번호·설명 시트 등이 있을 경우)는 **실데이터가 아니므로 제외**하면 됩니다.
